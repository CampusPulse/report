---
layout: default
title: Report Summary
---

<h1>{{page.title}}</h1>
<div class="summary">
	<!-- Summary fields will be populated here -->
	<div id="submitButton"></div>
</div>


<script>

	const submitButton = document.getElementById("submitButton");
	const summary = document.getElementsByClassName("summary")[0];


	function toHumanString( ident_string ) {
		let string = ident_string.replaceAll("_", " ");
		string = string.replaceAll("-", " ");

		string = string.split(" ").map(word => {
			return word.charAt(0).toUpperCase() + word.slice(1);
		}).join(" ");

		return string;
	}

	// Populate fields with URL parameters
	const params = new URLSearchParams(window.location.search);

	let internal_params = {};
	let summary_params = {};
	// loop through the query parameters and partition the parameters based on internal or not( do they start with an underscore)

	for (const [key, value] of params) {
		if (!key.startsWith("_")) {
			summary_params[key] = value;
		} else {
			internal_params[key] = value;
		}
	}
	for (const [key, value] of params) {
		if ( !key.startsWith("_")) {
			if (value === ""){
				continue;
			}
			const summaryElement = document.createElement("p");
			summaryElement.innerHTML = `<strong>${toHumanString(key)}:</strong> <span id="${key}">${value}</span>`
			summary.insertBefore(summaryElement, submitButton);
		} else {
			// check the internal key so we can handle it specifically
			if (key === "_sys_id") {
				// if the key is _sys_id, we need to create the form submission button
				const buttonlink = document.createElement("a");
				buttonlink.href = `https://{{ site.servicenow_domain }}/sp?id=sc_cat_item&sys_id=${value}`;
				const button = document.createElement("button");
				button.innerHTML = "Submit to {{ site.servicenow_domain }}";
				buttonlink.appendChild(button);
				submitButton.appendChild(buttonlink);
			}

		}
	}
</script>